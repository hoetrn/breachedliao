
<!-- header & setup -->
<h1 class="gradient-text">Hygiene Report for <%= email %></h1>

<% let trafficColor = riskScore <= 33 ? 'green' : riskScore <= 66 ? 'orange' : 'red'; %>
<% let riskLabel = riskScore <= 33 ? 'Low Risk' : riskScore <= 66 ? 'Moderate Risk' : 'High Risk'; %>

<!-- score indicator -->
<div style="text-align: center;">
  <div style="display: flex; justify-content: center; align-items: center; gap: 1rem;">
    <div class="risk-dot <%= riskLabel.toLowerCase().replace(' ', '-') %>"></div>
    <h2><strong>Risk Score: <%= riskScore %>/100</strong></h2>
  </div>
  <p><%= riskLabel %></p>
</div>

<% if (breaches.length > 0) { %>
  <div class="alert">
    <strong>Wah! Your email appeared in <%= breaches.length %> breach(es).</strong>
    <ul>
      <% breaches.forEach(breach => { %>
        <% const formattedDate = new Date(breach.BreachDate).toLocaleDateString("en-SG", { year: "numeric", month: "short", day: "numeric" }); %>
        <li><strong><%= breach.Name %></strong> — Breached on <%= formattedDate %></li>
      <% }) %>
    </ul>
  </div>

  <!-- recommendations placeholder -->
  <%
// Personalized recommendation bank
const allRecommendations = {
  low: [
    { text: "Check your account recovery settings", link: "https://support.google.com/accounts/answer/183723?hl=en" },
    { text: "Review your email forwarding rules", link: "https://proton.me/support/email-forwarding" }
  ],
  moderate: [
    { text: "Change your password regularly", link: "https://www.csa.gov.sg/our-programmes/cybersecurity-outreach/sg-cyber-safe-seniors/reading-and-printable-resources/infographics-and-posters/activities" },
    { text: "Enable two-factor authentication", link: "https://www.csa.gov.sg/our-programmes/cybersecurity-outreach/cybersecurity-campaigns/better-cyber-safe-than-sorry-campaign/use-strong-passwords-and-enable-2fa#688948caa2cf6675137a669fe16556ee" }
  ],
  high: [
    { text: "Use a password manager to generate strong passwords", link: "https://www.csa.gov.sg/our-programmes/cybersecurity-outreach/cybersecurity-campaigns/better-cyber-safe-than-sorry-campaign/use-strong-passwords-and-enable-2fa" },
    { text: "Secure breached accounts immediately", link: "https://www.haveibeenpwned.com/FAQs" }
  ]
};
%>
<% } else { %>
  <div class="safe">
    <strong>Solid!! — no known breaches found for your email.</strong>
  </div>
<% } %>
